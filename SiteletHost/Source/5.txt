module ConsoleLog =
    open IntelliFactory.WebSharper

    /// Client-side code.
    [<JavaScript>]
    module private Client =
        open IntelliFactory.WebSharper.Html

        /// Creates an input element.
        let inputElt _ =
            Input [
                Attr.Class "form-control"
                Attr.Type "text"
                Attr.Value "Hello console!"
                HTML5.Attr.AutoFocus "autofocus"
            ]

        /// Creates a button that logs the value
        /// of the specified element when clicked.
        let logBtn (elt:Element) =
            Button [
                Attr.Class "btn btn-primary"
                Attr.Type "button"
            ]
            -- Text "Log"
            |>! OnClick (fun _ _ -> JavaScript.Log elt.Value)
        
        let main() =
            let input = inputElt ()
            Div [Attr.Id "console-log"] -< [
                Legend [Text "Log messages to the console"]
                FieldSet [Attr.Class "form-group"] -< [
                    Label [Text "Message"]
                    input
                ]
                logBtn input
            ]

    /// A control for serving the main pagelet.
    type Control() =
        inherit Web.Control()

        [<JavaScript>]
        override this.Body = Client.main() :> _