(function(){var $$=this,$=this.IntelliFactory.Runtime,a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E;$.Define($$,{IntelliFactory:{WebSharper:{Control:{Disposable:{Of:function(F){return{Dispose:F};}},Event:{Event:$.Class({AddHandler:function(G){return this.Handlers.Add(G);},RemoveHandler:function(H){var I;I=this.Handlers;return b.iter(function(J){return I.RemoveAt(J);},c.tryFindIndex(function(K){return d.Equals(H,K);},this.Handlers));},Subscribe:function(L){var M,P=this;M=function(N){return L.OnNext(N);};this.AddHandler(M);return f.Of(function(){return P.RemoveHandler(M);});},Trigger:function(Q){var R,S;R=this.Handlers.ToArray();for(S=0;S<=R.length-1;S++){(g.GetArray(R,S))(Q);}return;}})},EventModule:{Choose:function(T,U){var V;V=h.New();i.addListener(U,function(W){var X;X=T(W);return X.$==0?null:V.event.Trigger(X.$0);});return V.event;},Filter:function(Y,Z){var _0;_0=$.New(k,{Handlers:n.New1()});i.addListener(Z,function(_1){return Y(_1)?_0.Trigger(_1):null;});return _0;},Map:function(_2,_3){var _4;_4=$.New(k,{Handlers:n.New1()});i.addListener(_3,function(_5){return _4.Trigger(_2(_5));});return _4;},Merge:function(_6,_7){var _8;_8=$.New(k,{Handlers:n.New1()});i.addListener(_6,function(_9){return _8.Trigger(_9);});i.addListener(_7,function(_){return _8.Trigger(_);});return _8;},Pairwise:function(ba){var bb,bc;bb={contents:{$:0}};bc=$.New(k,{Handlers:n.New1()});i.addListener(ba,function(bd){var be,bf;be=bb.contents;if(be.$==1){bf=be.$0;bb.contents={$:1,$0:bd};return bc.Trigger([bf,bd]);}else{bb.contents={$:1,$0:bd};return;}});return bc;},Partition:function(bf,bg){return[o.Filter(bf,bg),o.Filter(function(bh){return!bf(bh);},bg)];},Scan:function(bi,bj,bk){var bl;bl={contents:bj};return o.Map(function(bm){bl.contents=(bi(bl.contents))(bm);return bl.contents;},bk);},Split:function(bn,bo){return[o.Choose(function(bp){var bq;bq=bn(bp);return bq.$==0?{$:1,$0:bq.$0}:{$:0};},bo),o.Choose(function(br){var bs;bs=bn(br);return bs.$==1?{$:1,$0:bs.$0}:{$:0};},bo)];}},FSharpEvent:$.Class({},{New:function(){var bt;bt=$.New(this,{});bt.event=$.New(k,{Handlers:n.New1()});return bt;}}),HotStream:{HotStream:$.Class({Subscribe:function(bu){if(this.Latest.contents.$==1){bu.OnNext(this.Latest.contents.$0);}return i.subscribeTo(this.Event.event,function(bv){return bu.OnNext(bv);});},Trigger:function(bw){this.Latest.contents={$:1,$0:bw};return this.Event.event.Trigger(bw);}},{New:function(){return $.New(q,{Latest:{contents:{$:0}},Event:h.New()});}})},MailboxProcessor:$.Class({PostAndAsyncReply:function(bx,by){var bA=this;return r.Delay(function(){return r.Bind(bA.PostAndTryAsyncReply(bx,by),function(bB){return r.Return(bB.$==1?bB.$0:s.Raise(new t("TimeoutException")));});});},PostAndTryAsyncReply:function(bC,bD){var bE,bJ=this;bE=s.DefaultArg(bD,this.get_DefaultTimeout());return r.FromContinuations($.Tupled(function(bF){var bG,bH,bI,bL;bG=bF[0];bH=bF[1];bI=bF[2];if(bE<0){bJ.mailbox.AddLast(bC(function(bK){return bG({$:1,$0:bK});}));return bJ.resume();}else{bL={contents:true};bJ.mailbox.AddLast(bC(function(bM){if(bL.contents){bL.contents=false;return bG({$:1,$0:bM});}else{return null;}}));bJ.resume();u(function(){if(bL.contents){bL.contents=false;return bG({$:0});}else{return null;}},bE);return;}}));},Receive:function(bO){var bQ=this;return r.Delay(function(){return r.Bind(bQ.TryReceive(bO),function(bR){return r.Return(bR.$==1?bR.$0:s.Raise(new t("TimeoutException")));});});},Scan:function(bS,bT){var bV=this;return r.Delay(function(){return r.Bind(bV.TryScan(bS,bT),function(bW){return r.Return(bW.$==1?bW.$0:s.Raise(new t("TimeoutException")));});});},Start:function(){var bZ=this;if(this.started){return s.FailWith("The MailboxProcessor has already been started.");}else{this.started=true;return this.startAsync(r.Delay(function(){return r.TryWith(r.Delay(function(){return r.Bind(bZ.initial.call(null,bZ),function(){return r.Return(null);});}),function(b1){bZ.errorEvent.event.Trigger(b1);return r.Return(null);});}));}},TryReceive:function(b2){var b3,b8=this;b3=s.DefaultArg(b2,this.get_DefaultTimeout());return r.FromContinuations($.Tupled(function(b4){var b5,b6,b7,b_,b$;b5=b4[0];b6=b4[1];b7=b4[2];if(d.Equals(b8.mailbox.get_First(),null)){if(b3<0){b8.savedCont={$:1,$0:r.Delay(function(){b5({$:1,$0:b8.dequeue()});return r.Return(null);})};return;}else{b_={contents:true};b$=u(function(){if(b_.contents){b_.contents=false;b8.savedCont={$:0};return b5({$:0});}else{return null;}},b3);b8.savedCont={$:1,$0:r.Delay(function(){if(b_.contents){b_.contents=false;v(b$);b5({$:1,$0:b8.dequeue()});return r.Return(null);}else{return r.Return(null);}})};return;}}else{return b5({$:1,$0:b8.dequeue()});}}));},TryScan:function(cc,cd){var ce,ch=this;ce=s.DefaultArg(cd,this.get_DefaultTimeout());return r.Delay(function(){var cg,ci,cj,ck;cg=ch.mailbox.get_First();ci={$:0};while(!d.Equals(cg,null)){ck=cc(cg.v);if(ck.$==0){cg=cg.n;}else{ch.mailbox.Remove(cg);cg=null;ci=ck;}}cj=ci;return cj.$==1?r.Bind(cj.$0,function(cl){return r.Return({$:1,$0:cl});}):r.FromContinuations($.Tupled(function(cm){var cn,co,cp,cq,cw,cx,cz;cn=cm[0];co=cm[1];cp=cm[2];if(ce<0){cq=function(){ch.savedCont={$:1,$0:r.Delay(function(){var ct,cu;ct=cc(ch.mailbox.get_First().v);if(ct.$==1){cu=ct.$0;ch.mailbox.RemoveFirst();return r.Bind(cu,function(cv){cn({$:1,$0:cv});return r.Return(null);});}else{cq(null);return r.Return(null);}})};return;};return cq(null);}else{cw={contents:true};cx=u(function(){if(cw.contents){cw.contents=false;ch.savedCont={$:0};return cn({$:0});}else{return null;}},ce);cz=function(){ch.savedCont={$:1,$0:r.Delay(function(){var cC,cD;cC=cc(ch.mailbox.get_First().v);if(cC.$==1){cD=cC.$0;ch.mailbox.RemoveFirst();return r.Bind(cD,function(cE){if(cw.contents){cw.contents=false;v(cx);cn({$:1,$0:cE});return r.Return(null);}else{return r.Return(null);}});}else{cz(null);return r.Return(null);}})};return;};return cz(null);}}));});},dequeue:function(){var cF;cF=this.mailbox.get_First().v;this.mailbox.RemoveFirst();return cF;},get_CurrentQueueLength:function(){return this.mailbox.get_Count();},get_DefaultTimeout:function(){return this["DefaultTimeout@"];},get_Error:function(){return this.errorEvent.event;},resume:function(){var cG,cH;cG=this.savedCont;if(cG.$==1){cH=cG.$0;this.savedCont={$:0};return this.startAsync(cH);}else{return null;}},set_DefaultTimeout:function(cI){this["DefaultTimeout@"]=cI;return;},startAsync:function(cJ){return r.Start(cJ,this.token);}},{New:function(cK,cL){var cM,cN;cM=$.New(this,{});cM.initial=cK;cM.token=cL;cM.started=false;cM.errorEvent=h.New();cM.mailbox=x.New();cM.savedCont={$:0};cN=cM.token;if(cN.$==0){}else{r.Register(cN.$0,function(){return function(){return cM.resume();}();});}cM["DefaultTimeout@"]=-1;return cM;},Start:function(cQ,cR){var cS;cS=y.New(cQ,cR);cS.Start();return cS;}}),Observable:{Aggregate:function(cT,cU,cV){return z.New(function(cW){var cX;cX={contents:cU};return cT.Subscribe(A.New(function(cY){return z.Protect(function(){return(cV(cX.contents))(cY);},function(c0){cX.contents=c0;return cW.OnNext(c0);},function(c1){return cW.OnError(c1);});},function(c2){return cW.OnError(c2);},function(){return cW.OnCompleted();}));});},Choose:function(c4,c5){return z.New(function(c6){return c5.Subscribe(A.New(function(c7){var c9;c9=function(c_){return c6.OnNext(c_);};return z.Protect(function(){return c4(c7);},function(c$){return b.iter(c9,c$);},function(da){return c6.OnError(da);});},function(db){return c6.OnError(db);},function(){return c6.OnCompleted();}));});},CombineLatest:function(dd,de,df){return z.New(function(dg){var dh,di,dj,dr,dv,dz,dA;dh={contents:{$:0}};di={contents:{$:0}};dj=function(){var dl,dm,dn;dl=[dh.contents,di.contents];if(dl[0].$==1){if(dl[1].$==1){dm=dl[0].$0;dn=dl[1].$0;return z.Protect(function(){return(df(dm))(dn);},function(dp){return dg.OnNext(dp);},function(dq){return dg.OnError(dq);});}else{return null;}}else{return null;}};dr=A.New(function(ds){dh.contents={$:1,$0:ds};return dj(null);},function(){},function(){});dv=A.New(function(dw){di.contents={$:1,$0:dw};return dj(null);},function(){},function(){});dz=dd.Subscribe(dr);dA=de.Subscribe(dv);return f.Of(function(){dz.Dispose();return dA.Dispose();});});},Concat:function(dC,dD){return z.New(function(dE){var dF,dG;dF={contents:{$:0}};dG=dC.Subscribe(A.New(function(dH){return dE.OnNext(dH);},function(){},function(){dF.contents={$:1,$0:dD.Subscribe(dE)};}));return f.Of(function(){if(dF.contents.$==1){dF.contents.$0.Dispose();}return dG.Dispose();});});},Drop:function(dL,dM){return z.New(function(dN){var dO;dO={contents:0};return dM.Subscribe(A.New(function(dP){s.Increment(dO);return dO.contents>dL?dN.OnNext(dP):null;},function(dQ){return dN.OnError(dQ);},function(){return dN.OnCompleted();}));});},Filter:function(dS,dT){return z.New(function(dU){return dT.Subscribe(A.New(function(dV){var dX;dX=function(dY){return dU.OnNext(dY);};return z.Protect(function(){return dS(dV)?{$:1,$0:dV}:{$:0};},function(dZ){return b.iter(dX,dZ);},function(d0){return dU.OnError(d0);});},function(d1){return dU.OnError(d1);},function(){return dU.OnCompleted();}));});},Map:function(d3,d4){return z.New(function(d5){return d4.Subscribe(A.New(function(d6){return z.Protect(function(){return d3(d6);},function(d8){return d5.OnNext(d8);},function(d9){return d5.OnError(d9);});},function(d_){return d5.OnError(d_);},function(){return d5.OnCompleted();}));});},Merge:function(ea,eb){return z.New(function(ec){var ed,ee,ef,ej;ed={contents:false};ee={contents:false};ef=ea.Subscribe(A.New(function(eg){return ec.OnNext(eg);},function(){},function(){ed.contents=true;return(ed.contents?ee.contents:false)?ec.OnCompleted():null;}));ej=eb.Subscribe(A.New(function(ek){return ec.OnNext(ek);},function(){},function(){ee.contents=true;return(ed.contents?ee.contents:false)?ec.OnCompleted():null;}));return f.Of(function(){ef.Dispose();return ej.Dispose();});});},Never:function(){return z.New(function(){return f.Of(function(){});});},New:function(eq){return $.New(B,{Subscribe1:eq});},Observable:$.Class({Subscribe:function(er){return this.Subscribe1.call(null,er);}}),Of:function(es){return z.New(function(et){return f.Of(es(function(eu){return et.OnNext(eu);}));});},Protect:function(ev,ew,ex){var ey,ez;try{ey={$:0,$0:ev(null)};}catch(ez){ey={$:1,$0:ez};}return ey.$==1?ex(ey.$0):ew(ey.$0);},Range:function(eA,eB){return z.New(function(eC){var eD;for(eD=eA;eD<=eA+eB;eD++){eC.OnNext(eD);}return f.Of(function(){});});},Return:function(eF){return z.New(function(eG){eG.OnNext(eF);eG.OnCompleted();return f.Of(function(){});});},SelectMany:function(eI){return z.New(function(eJ){var eK,eM;eK={contents:function(){}};eM=i.subscribeTo(eI,function(eN){var eO;eO=i.subscribeTo(eN,function(eP){return eJ.OnNext(eP);});eK.contents=function(){eK.contents.call(null,null);return eO.Dispose();};return;});return f.Of(function(){eK.contents.call(null,null);return eM.Dispose();});});},Sequence:function(eS){var eT;eT=function(eU){return eU.$==1?z.CombineLatest(eU.$0,eT(eU.$1),function(eV){return function(eW){return $.New(D,{$:1,$0:eV,$1:eW});};}):z.Return($.New(D,{$:0}));};return eT(C.ofSeq(eS));},Switch:function(eX){return z.New(function(eY){var eZ,e0;eZ={contents:0};e0={contents:{$:0}};return i.subscribeTo(eX,function(e1){var e2;s.Increment(eZ);if(e0.contents.$==1){e0.contents.$0.Dispose();}e2=eZ.contents;e0.contents={$:1,$0:i.subscribeTo(e1,function(e3){return e2===eZ.contents?eY.OnNext(e3):null;})};return;});});}},ObservableModule:{Pairwise:function(e4){return z.New(function(e5){var e6;e6={contents:{$:0}};return e4.Subscribe(A.New(function(e7){var e8;e8=e6.contents;if(e8.$==1){e5.OnNext([e8.$0,e7]);}e6.contents={$:1,$0:e7};return;},function(e9){return e5.OnError(e9);},function(){return e5.OnCompleted();}));});},Partition:function(e$,fa){return[z.Filter(e$,fa),z.Filter(function(fb){return!e$(fb);},fa)];},Scan:function(fc,fd,fe){return z.New(function(ff){var fg;fg={contents:fd};return fe.Subscribe(A.New(function(fh){return z.Protect(function(){return(fc(fg.contents))(fh);},function(fj){fg.contents=fj;return ff.OnNext(fj);},function(fk){return ff.OnError(fk);});},function(fl){return ff.OnError(fl);},function(){return ff.OnCompleted();}));});},Split:function(fn,fo){var fp;fp=function(fq){var fr;fr=fn(fq);return fr.$==1?{$:1,$0:fr.$0}:{$:0};};return[z.Choose(function(fs){var ft;ft=fn(fs);return ft.$==0?{$:1,$0:ft.$0}:{$:0};},fo),z.Choose(fp,fo)];}},Observer:{New:function(fu,fv,fw){return $.New(E,{onNext:fu,onError:fv,onCompleted:fw});},Observer:$.Class({OnCompleted:function(){return this.onCompleted.call(null,null);},OnError:function(fx){return this.onError.call(null,fx);},OnNext:function(fy){return this.onNext.call(null,fy);}}),Of:function(fz){return $.New(E,{onNext:function(fA){return fz(fA);},onError:function(fB){return s.Raise(fB);},onCompleted:function(){return null;}});}}}}}});$.OnInit(function(){a=$.Safe($$.IntelliFactory.WebSharper);b=$.Safe(a.Option);c=$.Safe(a.Seq);d=$.Safe(a.Unchecked);e=$.Safe(a.Control);f=$.Safe(e.Disposable);g=$.Safe(a.IntrinsicFunctionProxy);h=$.Safe(e.FSharpEvent);i=$.Safe(a.Util);j=$.Safe(e.Event);k=$.Safe(j.Event);l=$.Safe(a.Collections);m=$.Safe(l.ResizeArray);n=$.Safe(m.ResizeArrayProxy);o=$.Safe(e.EventModule);p=$.Safe(e.HotStream);q=$.Safe(p.HotStream);r=$.Safe(a.Concurrency);s=$.Safe(a.Operators);t=$.Safe($$.Error);u=$.Safe($$.setTimeout);v=$.Safe($$.clearTimeout);w=$.Safe(l.LinkedList);x=$.Safe(w.ListProxy);y=$.Safe(e.MailboxProcessor);z=$.Safe(e.Observable);A=$.Safe(e.Observer);B=$.Safe(z.Observable);C=$.Safe(a.List);D=$.Safe(C.T);return E=$.Safe(A.Observer);});$.OnLoad(function(){return;});}());
