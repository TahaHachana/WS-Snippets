(function(){var $$=this,$=this.IntelliFactory.Runtime,a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D;$.Define($$,{WebSharper:{Control:{Disposable:{Of:function(E){return{Dispose:E};}},Event:{Event:$.Class({AddHandler:function(F){return this.Handlers.Add(F);},RemoveHandler:function(G){var H,J,K,M,N;H=function(I){return a.Equals(G,I);};J=this.Handlers;K=function(L){return J.RemoveAt(L);};M=this.Handlers;N=b.tryFindIndex(H,M);return c.iter(K,N);},Subscribe:function(O){var P,S=this;P=function(Q){return O.OnNext(Q);};this.AddHandler(P);return e.Of(function(){return S.RemoveHandler(P);});},Trigger:function(T){var U,V,W;U=this.Handlers.ToArray();for(V=0;V<=U.length-1;V++){W=f.get(U,V);W(T);}return;}})},EventModule:{Choose:function(X,Y){var Z;Z=g.New();h.addListener(Y,function(_0){var _1,_2,_3;_1=X(_0);if(_1.$==0){_2=null;}else{_3=_1.$0;_2=Z.event.Trigger(_3);}return _2;});return Z.event;},Filter:function(_4,_5){var _6;_6=$.New(j,{Handlers:m.New2()});h.addListener(_5,function(_7){return _4(_7)?_6.Trigger(_7):null;});return _6;},Map:function(_8,_9){var _;_=$.New(j,{Handlers:m.New2()});h.addListener(_9,function(ba){return _.Trigger(_8(ba));});return _;},Merge:function(ba,bb){var bc;bc=$.New(j,{Handlers:m.New2()});h.addListener(ba,function(bd){return bc.Trigger(bd);});h.addListener(bb,function(be){return bc.Trigger(be);});return bc;},Pairwise:function(bf){var bg,bh;bg={contents:{$:0}};bh=$.New(j,{Handlers:m.New2()});h.addListener(bf,function(bi){var bj,bk,bl;bj=bg.contents;if(bj.$==1){bl=bj.$0;bg.contents={$:1,$0:bi};bk=bh.Trigger([bl,bi]);}else{bk=void(bg.contents={$:1,$0:bi});}return bk;});return bh;},Partition:function(bm,bn){return[n.Filter(bm,bn),n.Filter(function(bo){var bp;bp=bm(bo);return!bp;},bn)];},Scan:function(bq,br,bs){var bt,bu;bt={contents:br};bu=function(bv){bt.contents=(bq(bt.contents))(bv);return bt.contents;};return n.Map(bu,bs);},Split:function(bw,bx){var by,bD;by=function(bz){var bA,bB,bC;bA=bw(bz);if(bA.$==0){bC=bA.$0;bB={$:1,$0:bC};}else{bB={$:0};}return bB;};bD=function(bE){var bF,bG,bH;bF=bw(bE);if(bF.$==1){bH=bF.$0;bG={$:1,$0:bH};}else{bG={$:0};}return bG;};return[n.Choose(by,bx),n.Choose(bD,bx)];}},FSharpEvent:$.Class({},{New:function(){var bI;bI=$.New(this,{});bI.event=$.New(j,{Handlers:m.New2()});return bI;}}),HotStream:{HotStream:$.Class({Subscribe:function(bJ){var bK,bL;this.Latest.contents.$==1?bJ.OnNext(this.Latest.contents.$0):null;bL=this.Event;bK=h.subscribeTo(bL.event,function(bM){return bJ.OnNext(bM);});return bK;},Trigger:function(bN){var bO;this.Latest.contents={$:1,$0:bN};bO=this.Event;return bO.event.Trigger(bN);}},{New:function(){return $.New(p,{Latest:{contents:{$:0}},Event:g.New()});}})},MailboxProcessor:$.Class({PostAndAsyncReply:function(bP,bQ){var bR,bU=this;bR=function(){var bT,bV;bT=bU.PostAndTryAsyncReply(bP,bQ);bV=function(bW){var bX,bY,bZ;if(bW.$==1){bZ=bW.$0;bY=bZ;}else{bY=q.Raise(new r("TimeoutException"));}bX=bY;return s.Return(bX);};return s.Bind(bT,bV);};return s.Delay(bR);},PostAndTryAsyncReply:function(b0,b1){var b2,b3,ca=this;b2=q.DefaultArg(b1,this.get_DefaultTimeout());b3=function(b4){var b5,b6,b7,b8,b9,b$,cb,cc,cf,cg;b5=b4[0];b6=b4[1];b7=b4[2];if(b2<0){b9=b0(function(b_){return b5({$:1,$0:b_});});b$=ca.mailbox.AddLast(b9);b8=ca.resume();}else{cb={contents:true};cc=b0(function(cd){var ce;if(cb.contents){cb.contents=false;ce=b5({$:1,$0:cd});}else{ce=null;}return ce;});cf=ca.mailbox.AddLast(cc);ca.resume();cg=t(function(){var ci;if(cb.contents){cb.contents=false;ci=b5({$:0});}else{ci=null;}return ci;},b2);b8=void cg;}return b8;};return s.FromContinuations(b3);},Receive:function(cj){var ck,cn=this;ck=function(){var cm,co;cm=cn.TryReceive(cj);co=function(cp){var cq,cr,cs;if(cp.$==1){cs=cp.$0;cr=cs;}else{cr=q.Raise(new r("TimeoutException"));}cq=cr;return s.Return(cq);};return s.Bind(cm,co);};return s.Delay(ck);},Scan:function(ct,cu){var cv,cy=this;cv=function(){var cx,cz;cx=cy.TryScan(ct,cu);cz=function(cA){var cB,cC,cD;if(cA.$==1){cD=cA.$0;cC=cD;}else{cC=q.Raise(new r("TimeoutException"));}cB=cC;return s.Return(cB);};return s.Bind(cx,cz);};return s.Delay(cv);},Start:function(){var cE,cF,cK=this,cR;if(this.started){cE=q.FailWith("The MailboxProcessor has already been started.");}else{this.started=true;cF=function(){var cH,cN,cO;cH=function(){var cJ,cL;cJ=cK.initial.call(null,cK);cL=function(){return s.Return(null);};return s.Bind(cJ,cL);};cN=s.Delay(cH);cO=function(cP){var cQ;cQ=cK.errorEvent;cQ.event.Trigger(cP);return s.Return(null);};return s.TryWith(cN,cO);};cR=s.Delay(cF);cE=cK.startAsync(cR);}return cE;},TryReceive:function(cS){var cT,cU,cZ=this;cT=q.DefaultArg(cS,this.get_DefaultTimeout());cU=function(cV){var cW,cX,cY,c0,c1,c2,c5,c6,c7,c_,dc,dd;cW=cV[0];cX=cV[1];cY=cV[2];if(a.Equals(cZ.mailbox.get_First(),null)){if(cT<0){c2=function(){var c4;c4=cZ.dequeue();cW({$:1,$0:c4});return s.Return(null);};c5=s.Delay(c2);c1=void(cZ.savedCont={$:1,$0:c5});}else{c6={contents:true};c7=t(function(){var c9;if(c6.contents){c6.contents=false;cZ.savedCont={$:0};c9=cW({$:0});}else{c9=null;}return c9;},cT);c_=function(){var da,db;if(c6.contents){c6.contents=false;u(c7);db=cZ.dequeue();cW({$:1,$0:db});da=s.Return(null);}else{da=s.Return(null);}return da;};dc=s.Delay(c_);c1=void(cZ.savedCont={$:1,$0:dc});}c0=c1;}else{dd=cZ.dequeue();c0=cW({$:1,$0:dd});}return c0;};return s.FromContinuations(cU);},TryScan:function(de,df){var dg,dh,dm=this;dg=q.DefaultArg(df,this.get_DefaultTimeout());dh=function(){var dj,dq,dr,ds,dt,dw,d1;dj=function(){var dl,dn,_do,dp;dl=dm.mailbox.get_First();dn={$:0};while(!a.Equals(dl,null)){_do=de(dl.v);if(_do.$==0){dp=dl=dl.n;}else{dm.mailbox.Remove(dl);dl=null;dp=dn=_do;}}return dn;};dq=dj(null);if(dq.$==1){ds=dq.$0;dt=function(du){var dv;dv={$:1,$0:du};return s.Return(dv);};dr=s.Bind(ds,dt);}else{dw=function(dx){var dy,dz,dA,dB,dC,dM,dN,dQ;dy=dx[0];dz=dx[1];dA=dx[2];if(dg<0){dC=function(){var dE,dL;dE=function(){var dG,dH,dI,dJ;dG=de(dm.mailbox.get_First().v);if(dG.$==1){dI=dG.$0;dm.mailbox.RemoveFirst();dJ=function(dK){dy({$:1,$0:dK});return s.Return(null);};dH=s.Bind(dI,dJ);}else{dC(null);dH=s.Return(null);}return dH;};dL=s.Delay(dE);dm.savedCont={$:1,$0:dL};return;};dB=dC(null);}else{dM={contents:true};dN=t(function(){var dP;if(dM.contents){dM.contents=false;dm.savedCont={$:0};dP=dy({$:0});}else{dP=null;}return dP;},dg);dQ=function(){var dS,d0;dS=function(){var dU,dV,dW,dX;dU=de(dm.mailbox.get_First().v);if(dU.$==1){dW=dU.$0;dm.mailbox.RemoveFirst();dX=function(dY){var dZ;if(dM.contents){dM.contents=false;u(dN);dy({$:1,$0:dY});dZ=s.Return(null);}else{dZ=s.Return(null);}return dZ;};dV=s.Bind(dW,dX);}else{dQ(null);dV=s.Return(null);}return dV;};d0=s.Delay(dS);dm.savedCont={$:1,$0:d0};return;};dB=dQ(null);}return dB;};d1=s.FromContinuations(dw);dr=d1;}return dr;};return s.Delay(dh);},dequeue:function(){var d2;d2=this.mailbox.get_First().v;this.mailbox.RemoveFirst();return d2;},get_CurrentQueueLength:function(){return this.mailbox.get_Count();},get_DefaultTimeout:function(){return this["DefaultTimeout@"];},get_Error:function(){var d3;d3=this.errorEvent;return d3.event;},resume:function(){var d4,d5,d6;d4=this.savedCont;if(d4.$==1){d6=d4.$0;this.savedCont={$:0};d5=this.startAsync(d6);}else{d5=null;}return d5;},set_DefaultTimeout:function(d7){this["DefaultTimeout@"]=d7;return;},startAsync:function(d8){var d9;d9=this.token;return s.Start(d8,d9);}},{New:function(d_,d$){var ea,eb,ec,ed,ee,eg;ea=$.New(this,{});ea.initial=d_;ea.token=d$;ea.started=false;ea.errorEvent=g.New();ea.mailbox=w.New();ea.savedCont={$:0};eb=ea.token;if(eb.$==0){ec=null;}else{ed=eb.$0;ee=function(){return ea.resume();};eg=s.Register(ed,function(){return ee();});ec=void eg;}ea["DefaultTimeout@"]=-1;return ea;},Start:function(ei,ej){var ek;ek=x.New(ei,ej);ek.Start();return ek;}}),Observable:{Aggregate:function(el,em,en){var eo;eo=function(ep){var eq,er,ew;eq={contents:em};er=function(es){return y.Protect(function(){return(en(eq.contents))(es);},function(eu){eq.contents=eu;return ep.OnNext(eu);},function(ev){return ep.OnError(ev);});};ew=z.New(er,function(ex){return ep.OnError(ex);},function(){return ep.OnCompleted();});return el.Subscribe(ew);};return y.New(eo);},Choose:function(ez,eA){var eB;eB=function(eC){var eD,eK;eD=function(eE){var eG;eG=function(eH){return eC.OnNext(eH);};return y.Protect(function(){return ez(eE);},function(eI){return c.iter(eG,eI);},function(eJ){return eC.OnError(eJ);});};eK=z.New(eD,function(eL){return eC.OnError(eL);},function(){return eC.OnCompleted();});return eA.Subscribe(eK);};return y.New(eB);},CombineLatest:function(eN,eO,eP){var eQ;eQ=function(eR){var eS,eT,eU,e4,e6,e9,e$,fc,fd;eS={contents:{$:0}};eT={contents:{$:0}};eU=function(){var eW,eX,eY,eZ,e0;eW=[eS.contents,eT.contents];if(eW[0].$==1){if(eW[1].$==1){eZ=eW[0].$0;e0=eW[1].$0;eY=y.Protect(function(){return(eP(eZ))(e0);},function(e2){return eR.OnNext(e2);},function(e3){return eR.OnError(e3);});}else{eY=null;}eX=eY;}else{eX=null;}return eX;};e4=function(e5){eS.contents={$:1,$0:e5};return eU(null);};e6=z.New(e4,function(){},function(){});e9=function(e_){eT.contents={$:1,$0:e_};return eU(null);};e$=z.New(e9,function(){},function(){});fc=eN.Subscribe(e6);fd=eO.Subscribe(e$);return e.Of(function(){fc.Dispose();return fd.Dispose();});};return y.New(eQ);},Concat:function(ff,fg){var fh;fh=function(fi){var fj,fk,fp;fj={contents:{$:0}};fk=ff.Subscribe(z.New(function(fl){return fi.OnNext(fl);},function(){},function(){var fo;fo=fg.Subscribe(fi);fj.contents={$:1,$0:fo};}));fp=function(){fj.contents.$==1?fj.contents.$0.Dispose():null;return fk.Dispose();};return e.Of(fp);};return y.New(fh);},Drop:function(fr,fs){var ft;ft=function(fu){var fv,fw,fy;fv={contents:0};fw=function(fx){q.Increment(fv);return fv.contents>fr?fu.OnNext(fx):null;};fy=z.New(fw,function(fz){return fu.OnError(fz);},function(){return fu.OnCompleted();});return fs.Subscribe(fy);};return y.New(ft);},Filter:function(fB,fC){var fD;fD=function(fE){var fF,fM;fF=function(fG){var fI;fI=function(fJ){return fE.OnNext(fJ);};return y.Protect(function(){return fB(fG)?{$:1,$0:fG}:{$:0};},function(fK){return c.iter(fI,fK);},function(fL){return fE.OnError(fL);});};fM=z.New(fF,function(fN){return fE.OnError(fN);},function(){return fE.OnCompleted();});return fC.Subscribe(fM);};return y.New(fD);},Map:function(fP,fQ){var fR;fR=function(fS){var fT,fY;fT=function(fU){return y.Protect(function(){return fP(fU);},function(fW){return fS.OnNext(fW);},function(fX){return fS.OnError(fX);});};fY=z.New(fT,function(fZ){return fS.OnError(fZ);},function(){return fS.OnCompleted();});return fQ.Subscribe(fY);};return y.New(fR);},Merge:function(f1,f2){var f3;f3=function(f4){var f5,f6,f7,f$,ga,ge;f5={contents:false};f6={contents:false};f7=z.New(function(f8){return f4.OnNext(f8);},function(){},function(){f5.contents=true;return(f5.contents?f6.contents:false)?f4.OnCompleted():null;});f$=f1.Subscribe(f7);ga=z.New(function(gb){return f4.OnNext(gb);},function(){},function(){f6.contents=true;return(f5.contents?f6.contents:false)?f4.OnCompleted():null;});ge=f2.Subscribe(ga);return e.Of(function(){f$.Dispose();return ge.Dispose();});};return y.New(f3);},Never:function(){return y.New(function(){return e.Of(function(){});});},New:function(gi){return $.New(A,{Subscribe1:gi});},Observable:$.Class({Subscribe:function(gj){return this.Subscribe1.call(null,gj);}}),Of:function(gk){return y.New(function(gl){return e.Of(gk(function(gm){return gl.OnNext(gm);}));});},Protect:function(gn,go,gp){var gq,gr,gs,gt,gu,gv;try{gr={$:0,$0:gn(null)};}catch(gs){gr={$:1,$0:gs};}gq=gr;if(gq.$==1){gu=gq.$0;gt=gp(gu);}else{gv=gq.$0;gt=go(gv);}return gt;},Range:function(gw,gx){var gy;gy=function(gz){var gA;for(gA=gw;gA<=gw+gx;gA++){gz.OnNext(gA);}return e.Of(function(){});};return y.New(gy);},Return:function(gC){var gD;gD=function(gE){gE.OnNext(gC);gE.OnCompleted();return e.Of(function(){});};return y.New(gD);},SelectMany:function(gG){return y.New(function(gH){var gI,gK;gI={contents:function(){}};gK=h.subscribeTo(gG,function(gL){var gM;gM=h.subscribeTo(gL,function(gN){return gH.OnNext(gN);});gI.contents=function(){gI.contents.call(null,null);return gM.Dispose();};return;});return e.Of(function(){gI.contents.call(null,null);return gK.Dispose();});});},Sequence:function(gQ){var gR;gR=function(gS){var gT,gU,gV,gW;if(gS.$==1){gU=gS.$1;gV=gS.$0;gW=gR(gU);gT=y.CombineLatest(gV,gW,function(gX){return function(gY){return $.New(C,{$:1,$0:gX,$1:gY});};});}else{gT=y.Return($.New(C,{$:0}));}return gT;};return gR(B.ofSeq(gQ));},Switch:function(gZ){return y.New(function(g0){var g1,g2,g3;g1={contents:0};g2={contents:{$:0}};g3=h.subscribeTo(gZ,function(g4){var g5,g6,g8;q.Increment(g1);g2.contents.$==1?g2.contents.$0.Dispose():null;g5=g1.contents;g6=h.subscribeTo(g4,function(g7){return g5===g1.contents?g0.OnNext(g7):null;});g8={$:1,$0:g6};g2.contents=g8;return;});return g3;});}},ObservableModule:{Pairwise:function(g9){var g_;g_=function(g$){var ha,hb,hg;ha={contents:{$:0}};hb=function(hc){var hd,he,hf;hd=ha.contents;if(hd.$==1){hf=hd.$0;he=g$.OnNext([hf,hc]);}else{he=null;}ha.contents={$:1,$0:hc};return;};hg=z.New(hb,function(hh){return g$.OnError(hh);},function(){return g$.OnCompleted();});return g9.Subscribe(hg);};return y.New(g_);},Partition:function(hj,hk){var hl;hl=function(hm){var hn;hn=hj(hm);return!hn;};return[y.Filter(hj,hk),y.Filter(hl,hk)];},Scan:function(ho,hp,hq){var hr;hr=function(hs){var ht,hu,hz;ht={contents:hp};hu=function(hv){return y.Protect(function(){return(ho(ht.contents))(hv);},function(hx){ht.contents=hx;return hs.OnNext(hx);},function(hy){return hs.OnError(hy);});};hz=z.New(hu,function(hA){return hs.OnError(hA);},function(){return hs.OnCompleted();});return hq.Subscribe(hz);};return y.New(hr);},Split:function(hC,hD){var hE,hJ,hK,hP;hE=function(hF){var hG,hH,hI;hG=hC(hF);if(hG.$==0){hI=hG.$0;hH={$:1,$0:hI};}else{hH={$:0};}return hH;};hJ=y.Choose(hE,hD);hK=function(hL){var hM,hN,hO;hM=hC(hL);if(hM.$==1){hO=hM.$0;hN={$:1,$0:hO};}else{hN={$:0};}return hN;};hP=y.Choose(hK,hD);return[hJ,hP];}},Observer:{New:function(hQ,hR,hS){return $.New(D,{onNext:hQ,onError:hR,onCompleted:hS});},Observer:$.Class({OnCompleted:function(){return this.onCompleted.call(null,null);},OnError:function(hT){return this.onError.call(null,hT);},OnNext:function(hU){return this.onNext.call(null,hU);}}),Of:function(hV){return $.New(D,{onNext:function(hW){return hV(hW);},onError:function(hX){return q.Raise(hX);},onCompleted:function(){return null;}});}}}}});$.OnInit(function(){a=$.Safe($$.WebSharper.Unchecked);b=$.Safe($$.WebSharper.Seq);c=$.Safe($$.WebSharper.Option);d=$.Safe($$.WebSharper.Control);e=$.Safe(d.Disposable);f=$.Safe($$.WebSharper.Arrays);g=$.Safe(d.FSharpEvent);h=$.Safe($$.WebSharper.Util);i=$.Safe(d.Event);j=$.Safe(i.Event);k=$.Safe($$.WebSharper.Collections);l=$.Safe(k.ResizeArray);m=$.Safe(l.ResizeArrayProxy);n=$.Safe(d.EventModule);o=$.Safe(d.HotStream);p=$.Safe(o.HotStream);q=$.Safe($$.WebSharper.Operators);r=$.Safe($$.Error);s=$.Safe($$.WebSharper.Concurrency);t=$.Safe($$.setTimeout);u=$.Safe($$.clearTimeout);v=$.Safe(k.LinkedList);w=$.Safe(v.ListProxy);x=$.Safe(d.MailboxProcessor);y=$.Safe(d.Observable);z=$.Safe(d.Observer);A=$.Safe(y.Observable);B=$.Safe($$.WebSharper.List);C=$.Safe(B.T);return D=$.Safe(z.Observer);});$.OnLoad(function(){return;});}());
